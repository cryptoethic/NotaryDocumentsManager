{"version":3,"sources":["../node_modules/@truffle/hdwallet-provider/node_modules/web3-eth-accounts/src sync","serviceWorker.js","views/ListItems.js","styles/Dashboard.js","styles/AddDocument.js","views/Title.js","helpers/miningStatusNotifier.js","views/DocumentInformations.js","views/DocumentView.js","views/tableIcons.js","views/FileTableView.js","styles/FileExplorer.js","components/FileExplorer.js","components/Home.js","styles/Home.js","views/AddDocumentForm.js","components/AddDocument.js","components/Error404.js","styles/Login.js","views/Login.js","helpers/web3Manager.js","components/Web3Provider.js","styles/NotaryManager.js","views/AddNotaryForm.js","views/EditNotaryForm.js","views/DeleteNotaryForm.js","views/ListAllNotaries.js","components/NotaryManager.js","views/AccountDataView.js","components/Dashboard.js","components/App.js","index.js","helpers/encryption.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Boolean","window","location","hostname","match","listMenuItems","isNotary","isNotaryManager","List","ListItem","button","component","Link","to","routes","home","ListItemIcon","ListItemText","primary","includeNotaryPanel","Tooltip","placement","title","addDocument","disabled","Divider","notaryManager","theme","root","display","toolbar","paddingRight","toolbarIcon","alignItems","justifyContent","padding","mixins","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","width","enteringScreen","menuButton","marginRight","menuButtonHidden","flexGrow","drawerPaper","overflow","position","whiteSpace","drawerPaperClose","overflowX","spacing","breakpoints","up","appBarSpacer","content","height","container","paddingTop","paddingBottom","paddingLeft","paper","flexDirection","fixedHeight","connectServerText","marginBottom","logout","color","border","hideProgress","visibility","loadingProgress","textField","actionButton","margin","textFieldRoot","dividerMargin","marginTop","uploadButton","seeMore","link","linkButton","Title","props","Typography","variant","gutterBottom","children","notifyOnMiningStatus","promiEvent","snackbar","slug","a","notistackKey","once","hash","enqueueSnackbar","action","key","IconButton","onClick","open","etherscanBaseUrl","closeSnackbar","confirmationNumber","receipt","console","log","transactionHash","useStyles","makeStyles","pulse","opacity","DocumentInformations","document","classes","Grid","item","xs","Table","size","TableHead","TableRow","TableCell","style","TableBody","name","date","notaryPublishedBy","undefined","notaryName","className","notarySurname","notaryOfficeLocation","AddDocumentStyles","DocumentView","handleShare","setDocument","handleDownload","web3Manager","setLoading","React","useEffect","handleLoadNotary","useState","error","publicKey","setPublicKey","useSnackbar","setSubmitInProgress","documentObj","notaryManagerContract","methods","call","notaries","result","notaryContractCloned","notaryContract","clone","options","address","surname","officeLocation","message","Paper","Fragment","TextField","label","onChange","event","target","value","Button","documentAddress","msg","tableIcons","Add","forwardRef","ref","Check","Clear","Delete","DetailPanel","Edit","Export","Filter","FirstPage","LastPage","NextPage","PreviousPage","ResetSearch","Search","SortArrow","ThirdStateCheck","ViewColumn","cursor","fetchingDataFromBlockchain","FileTableView","fetchingDocuments","rows","fileExplorerComponentMounted","refreshDocuments","Fade","in","timeout","justify","direction","CircularProgress","handleDownloadDocuments","context","documents","length","downloadDocumentsPromises","map","doc","Promise","reject","then","catch","all","downloadResult","failedDocs","filter","elem","handleShareDocuments","isValidPublicKey","shareDocumentsPromises","shareResult","columns","field","render","row","preventDefault","defaultSort","customSort","b","timestamp","data","icons","actions","icon","tooltip","filtering","sorting","grouping","draggable","paging","pageSize","pageSizeOptions","selection","actionsColumnIndex","localization","body","emptyDataSourceMessage","createData","shortDescription","FileExplorer","selectedAddress","selectedDocument","setFetchingDocuments","componentMounted","setComponentMounted","uniqueDocuments","setUniqueDocuments","setRows","updateUniqueDocuments","getFilesData","loadDocuments","startingIndex","count","Exception","fetchAllDocuments","slice","documentContractCloned","documentContract","ipfsHash","createdAt","Date","toLocaleString","allDocuments","pages","Math","ceil","currentPage","totalDocuments","push","documentManagerContract","getDocuments","uniqueDocumentsFromBlockchain","Set","reverse","targetPublicKey","decryptionKeys","accountEncryptedKeySimplified","accountEncryptedKey","EthCrypto","cipher","parse","decryptWithPrivateKey","getPrivateKeyForSelectedAddress","accountDecryptedKey","encryptWithPublicKey","toShareEncryptedKey","stringify","targetAddress","toAddress","deploymentPromiEvent","addPermission","miningStatus","keySimplified","decryptedKey","config","axiosInstance","Axios","withCredentials","get","publicIpfsGateway","responseType","ipfsDownloadTimeout","encryptedDocument","ipfsGateway","toBuffer","err","buffer","contentArrayBuffer","decryptedContent","encryption","decrypt","blob","Blob","type","saveAs","Home","AddDocumentForm","file","setFile","fileName","setFileName","setTitle","submitInProgress","handleChange","inputName","files","handleSubmit","formData","FormData","append","axios","post","apiUrl","headers","myEncryptionKey","getPublicKeyForSelectedAddress","myEncryptedKey","myEncryptedKeyAsString","inputProps","autoComplete","AddDocument","Error404","Login","password","setPassword","loginInProgress","setLoginInProgress","handleLogin","login","response","success","setLoggedIn","onKeyPress","ev","autoFocus","bip39","require","web3Manger","this","web3","accountChangeListeners","wei","unit","utils","fromWei","isAddress","pubKey","isValidAddress","accountInfo","forEach","callback","currentProvider","wallets","toString","privKey","eth","getBalance","generateMnemonic","mnemonic","Web3","HDWalletProvider","addresses","Contract","NotaryManager","abi","notaryManagerAddress","DocumentManager","documentManagerAddress","Document","Notary","isOwner","from","deploy","bytecode","arguments","send","contractAddress","addNotary","method","notaryPublicKey","removeNotary","account","getPastEvents","fromBlock","notaryStatusChangeRawEvents","notaryStatusChangeEvents","returnValues","status","block","blockNumber","notariesStatuses","listOfAllNotaries","Object","notaryStatus","dashboardStyles","Web3Provider","setNotaryManager","setNotary","setAccountSelected","setMnemonic","web3Initialised","setWeb3Initialized","web3FailedInitialization","setSelectedAddress","updateAccountSelected","initWeb3Manager","handleCreateAccount","newMnemonic","notariesList","notaryManagerStyles","AddNotaryForm","setName","setSurname","setOfficeLocation","notaryAccount","setNotaryAccount","notaryContractAddress","addNotaryPromiEvent","deployNotary","deployedContract","_address","grantPrivileges","EditNotaryForm","setNotaryPublicKey","notaryAccountAddress","setNotaryAccountAddress","handleUpdateNotary","updateNotaryPromiEvent","updateNotary","flex","DeleteNotaryForm","handleRemoveNotary","removeNotaryPromiEvent","ListAllNotaries","listAllNotaries","components","Container","AccountDataView","setOpen","curentBalanceText","setCurentBalanceText","getCurrentBalance","Dialog","onClose","maxWidth","DialogTitle","DialogContent","Dashboard","localStorage","getItem","isLoading","accountSelected","loggedIn","logoutInProgress","setLogoutInProgress","handleLogout","setItem","CssBaseline","AppBar","clsx","Toolbar","edge","aria-label","noWrap","Drawer","LinearProgress","exact","path","createMuiTheme","palette","main","contrastText","secondary","danger","defaults","ReactDOM","notistackRef","createRef","maxSnack","current","autoHideDuration","getElementById","navigator","serviceWorker","ready","registration","unregister","encrypt","crypto","createCipher","Buffer","concat","update","final","decipher","createDecipher"],"mappings":"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","file":"static/js/main.ca742969.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 1080;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport {Link} from \"react-router-dom\";\r\nimport routes from '../routes.json';\r\nimport { Divider, List, Tooltip } from '@material-ui/core';\r\nimport {includeNotaryPanel} from '../config.json';\r\n \r\nexport const listMenuItems = (isNotary, isNotaryManager) => (\r\n  <div>\r\n\r\n    <List>\r\n     \r\n      <ListItem button component={Link} to={routes.home}>\r\n        <ListItemIcon>\r\n          <DashboardIcon />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Przeglądaj dokumenty\" />\r\n      </ListItem> \r\n      {includeNotaryPanel && ( \r\n        <Tooltip placement=\"right\" title={isNotary?\"\":\"Przełącz się na konto notariusza aby uzyskać dostęp do tej zakładki.\"}> \r\n          <div>\r\n            <ListItem button component={Link} to={routes.addDocument} disabled={!isNotary}>\r\n              <ListItemIcon>\r\n                <AddIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Dodaj nowy dokument\" />\r\n            </ListItem>\r\n          </div>\r\n        </Tooltip> \r\n      )}\r\n    </List>\r\n    \r\n    {includeNotaryPanel && <Divider />}\r\n    \r\n    {includeNotaryPanel && ( \r\n      <List>\r\n        <Tooltip placement=\"right\" title={isNotaryManager?\"\":\"Przełącz się na konto administratora systemu aby uzyskać dostęp do tej zakładki.\"}> \r\n          <div>\r\n            <ListItem button component={Link} to={routes.notaryManager}  disabled={!isNotaryManager}>\r\n              <ListItemIcon>\r\n                <SettingsIcon />\r\n              </ListItemIcon>\r\n              <ListItemText primary=\"Zarządzaj notariuszami\" />\r\n            </ListItem> \r\n          </div>\r\n        </Tooltip>\r\n      </List> \r\n    )}\r\n  </div>\r\n);\r\n\r\n","\r\nconst drawerWidth = 280;\r\n\r\nexport default (theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n  },\r\n  toolbar: {\r\n    paddingRight: 24, // keep right padding when drawer closed\r\n  },\r\n  toolbarIcon: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: '0 8px',\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  menuButtonHidden: {\r\n    display: 'none',\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  drawerPaper: {\r\n    overflow: 'hidden',\r\n    position: 'relative',\r\n    whiteSpace: 'nowrap',\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerPaperClose: {\r\n    overflowX: 'hidden',\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    width: theme.spacing(7),\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  appBarSpacer: theme.mixins.toolbar,\r\n  content: {\r\n    flexGrow: 1,\r\n    height: '100vh',\r\n    overflow: 'auto',\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(2),\r\n    paddingBottom: theme.spacing(4),\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(2)\r\n  },\r\n  paper: {\r\n    padding: theme.spacing(4),\r\n    display: 'flex',\r\n    overflow: 'auto',\r\n    flexDirection: 'column',\r\n  },\r\n  fixedHeight: {\r\n    height: 240,\r\n  },\r\n  connectServerText:{\r\n    marginBottom: theme.spacing(4)\r\n  },\r\n  logout:{\r\n    color:'#ffffff',\r\n    '&$disabled': {\r\n      color: 'rgba(255, 255, 255, 0.26)',\r\n      border: '1px solid rgba(255, 255, 255, 0.26);'\r\n    }\r\n  },\r\n  disabled:{},\r\n  hideProgress:{\r\n    visibility: 'hidden'\r\n  },\r\n  loadingProgress:{\r\n    position:'absolute',\r\n    width:'100%'\r\n  },\r\n  textField:{\r\n    width:'100%'\r\n  },\r\n  actionButton:{\r\n    margin: '8px 8px'\r\n  }\r\n});\r\n","export default (theme) => ({ \r\n    paper: {\r\n      padding: theme.spacing(2),\r\n      display: 'flex',\r\n      overflow: 'auto',\r\n      flexDirection: 'column',\r\n    },\r\n    textFieldRoot: { \r\n      marginLeft: theme.spacing(1),\r\n      marginRight: theme.spacing(1),\r\n      marginBottom: theme.spacing(1)\r\n    },\r\n    textField: {\r\n      width: '100%',\r\n    },\r\n    dividerMargin:{\r\n      marginTop: theme.spacing(1),\r\n      marginBottom: theme.spacing(2)\r\n    },\r\n    uploadButton:{\r\n      margin:\"0 5%\",\r\n      width:'90%',\r\n      height:'10vh',\r\n      marginTop: theme.spacing(1),\r\n      marginBottom: theme.spacing(2)\r\n    },\r\n    seeMore: {\r\n      marginTop: theme.spacing(3),\r\n    },\r\n    link: {\r\n      padding: \"0 0.5rem\"\r\n    },\r\n    linkButton: {\r\n      margin: \"1rem 0\"\r\n    },\r\n    textField: {\r\n      width: '100%',\r\n      margin: '1rem 0',\r\n    },\r\n    fetchingDataFromBlockchain: {\r\n      marginTop: theme.spacing(3)\r\n    }\r\n  });\r\n  ","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nexport default function Title(props) {\r\n  return (\r\n    <Typography component=\"h2\" variant=\"h6\" color=\"primary\" gutterBottom> \r\n      {props.children}\r\n    </Typography>\r\n  );\r\n}\r\n ","import React, { Fragment } from 'react';\r\nimport { IconButton, Button } from \"@material-ui/core\";\r\nimport OpenInNewIcon from '@material-ui/icons/OpenInNew';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport {etherscanBaseUrl} from '../config.json';\r\n\r\n\r\nconst notifyOnMiningStatus = async (promiEvent, snackbar, slug) => {\r\n  let notistackKey = null;\r\n  promiEvent\r\n    .once('transactionHash', function(hash){ \r\n      notistackKey = snackbar.enqueueSnackbar(`${slug ? `[${slug}] `: ``}Transakcja oczekuje na wykopanie.`,{\r\n        variant: 'info',\r\n        action: (key) => (\r\n          <Fragment>\r\n            <IconButton color=\"inherit\" onClick={() => {\r\n              window.open(`${etherscanBaseUrl}/tx/${hash}`, \"_blank\"); \r\n            } }>\r\n              <OpenInNewIcon/>\r\n            </IconButton>\r\n            <IconButton color=\"inherit\" onClick={() => { \r\n              snackbar.closeSnackbar(key);\r\n            }}>\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </Fragment>\r\n        )\r\n      });\r\n    })\r\n    .once('confirmation', function(confirmationNumber, receipt){ \r\n      console.log('confirmation', confirmationNumber, receipt);\r\n      snackbar.enqueueSnackbar(`${slug ? `[${slug}] `: ``}Transakcja potwierdzona przez blockchain`, {\r\n        variant: 'success',\r\n        action: (key) => (\r\n          <Fragment>\r\n            <IconButton color=\"inherit\" onClick={() => {\r\n              window.open(`${etherscanBaseUrl}/tx/${receipt.transactionHash}`, \"_blank\"); \r\n            } }>\r\n              <OpenInNewIcon/>\r\n            </IconButton>\r\n            <IconButton color=\"inherit\" onClick={() => { \r\n              snackbar.closeSnackbar(key);\r\n            }}>\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </Fragment>\r\n        )\r\n      });\r\n      snackbar.closeSnackbar(notistackKey); \r\n    });\r\n  return promiEvent;\r\n}\r\n\r\nexport default notifyOnMiningStatus;\r\n","import React from 'react';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button, Table, TableHead, TableRow, TableCell, TableBody } from '@material-ui/core'; \r\nimport { makeStyles } from '@material-ui/core/styles'; \r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier';\r\nimport axios from 'axios';\r\nimport config from '../config.json';  \r\n \r\nconst useStyles = makeStyles(theme => ({\r\n  pulse: {\r\n    opacity: 0.7\r\n  }   \r\n}));\r\n\r\nexport default function DocumentInformations(props) {\r\n  const { document } = props;\r\n  const classes = useStyles();\r\n \r\n  return (\r\n    <Grid container> \r\n      <Grid item xs={12}> \r\n        <Table size=\"small\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell style={{ width: '30%' }}>Parametr</TableCell>\r\n              <TableCell>Wartość</TableCell> \r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody> \r\n            <TableRow >                      \r\n              <TableCell>Nazwa</TableCell>\r\n              <TableCell >\r\n                {document.name}\r\n              </TableCell>\r\n            </TableRow> \r\n\r\n            <TableRow >                      \r\n              <TableCell>Hash IPFS</TableCell>\r\n              <TableCell >\r\n                {document.link}  \r\n              </TableCell>\r\n            </TableRow> \r\n\r\n            <TableRow >                      \r\n              <TableCell>Data utworzenia</TableCell>\r\n              <TableCell >\r\n                {document.date}  \r\n              </TableCell>\r\n            </TableRow> \r\n            \r\n            <TableRow >  \r\n              <TableCell>Kryptowalutowy adres notariusza</TableCell>\r\n              <TableCell>\r\n                {document.notaryPublishedBy}  \r\n              </TableCell>\r\n            </TableRow> \r\n\r\n            <TableRow >  \r\n              <TableCell>Imię notariusza</TableCell>\r\n              <TableCell >\r\n                {document.notaryName === undefined && (\r\n                  <div className={classes.pulse}>\r\n                    Wczytywanie...\r\n                  </div>\r\n                )}  \r\n                {document.notaryName}\r\n              </TableCell>\r\n            </TableRow> \r\n\r\n            <TableRow >  \r\n              <TableCell>Nazwisko notariusza</TableCell>\r\n              <TableCell >\r\n                {document.notarySurname === undefined && (\r\n                  <div className={classes.pulse}>\r\n                    Wczytywanie...\r\n                  </div>\r\n                )}  \r\n                {document.notarySurname}  \r\n              </TableCell>\r\n            </TableRow> \r\n\r\n            <TableRow >  \r\n              <TableCell>Biuro notariusza</TableCell>\r\n              <TableCell >\r\n                {document.notaryOfficeLocation === undefined && (\r\n                  <div className={classes.pulse}>\r\n                    Wczytywanie...\r\n                  </div>\r\n                )} \r\n                {document.notaryOfficeLocation}  \r\n              </TableCell>\r\n            </TableRow> \r\n\r\n\r\n          </TableBody>\r\n        </Table> \r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, IconButton } from '@material-ui/core';\r\nimport AddDocumentStyles from '../styles/AddDocument';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport DocumentInformations from './DocumentInformations'\r\nimport Title from './Title';\r\nimport { useParams } from \"react-router\";\r\nimport { useSnackbar } from 'notistack';\r\nimport { CircularProgress, Fade } from '@material-ui/core';\r\nimport Axios from 'axios';\r\nimport config from '../config.json';\r\nimport { saveAs } from 'file-saver';\r\nimport Link from '@material-ui/core/Link';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button'\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nconst useStyles = makeStyles(AddDocumentStyles);\r\n\r\n\r\n\r\nexport default function DocumentView(props) {\r\n  const {\r\n    handleShare,\r\n    document,\r\n    setDocument,\r\n    handleDownload,\r\n    web3Manager,\r\n    setLoading } = props;\r\n\r\n  React.useEffect(() => {\r\n    handleLoadNotary();\r\n  }, []);\r\n\r\n  const classes = useStyles();\r\n\r\n\r\n  const [error, setError] = React.useState(undefined)\r\n  const [publicKey, setPublicKey] = React.useState('');\r\n  const snackbar = useSnackbar();\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false);\r\n\r\n  const handleLoadNotary = async () => {\r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      const documentObj = document;\r\n      const isNotary = await web3Manager.notaryManagerContract.methods.isNotary(document.notaryPublishedBy).call();\r\n      if (!isNotary) {\r\n        return snackbar.enqueueSnackbar('Podany klucz publiczny nie należy do żadnego notariusza w tym systemie.', { variant: 'error' });\r\n      }\r\n      const result = await web3Manager.notaryManagerContract.methods.notaries(document.notaryPublishedBy).call();\r\n      const notaryContractCloned = web3Manager.notaryContract.clone();\r\n      notaryContractCloned.options.address = result;\r\n      documentObj[\"notaryName\"] = await notaryContractCloned.methods.name().call();\r\n      documentObj[\"notarySurname\"] = await notaryContractCloned.methods.surname().call();\r\n      documentObj[\"notaryOfficeLocation\"] = await notaryContractCloned.methods.officeLocation().call();  \r\n\r\n      setDocument(documentObj)\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się wczytać danych notariusza: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setSubmitInProgress(false);\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if (inputName === 'publicKey') {\r\n      setPublicKey(event.target.value);\r\n    }\r\n  };\r\n\r\n  return (\r\n\r\n    <Paper className={classes.paper} >\r\n      <Grid container spacing={3}>\r\n        <Grid item xs={12}>\r\n\r\n        <Grid container>\r\n          <Grid item style={{flexGrow: 1}}>\r\n\r\n          <Title>\r\n            Szczegóły dokumentu\r\n          </Title>\r\n          </Grid>\r\n          <Grid item>\r\n            <IconButton onClick={() => { \r\n              setDocument(undefined);\r\n            }}> \r\n              <CloseIcon />    \r\n            </IconButton>\r\n          </Grid>\r\n        </Grid>\r\n\r\n          <Title>\r\n            </Title>\r\n          <Typography variant=\"body1\">\r\n            W tym widoku znajdziesz szczegółowe informacje o dokumencie.\r\n            </Typography>\r\n\r\n\r\n\r\n          {error === undefined ?\r\n            <React.Fragment>\r\n\r\n              <DocumentInformations document={document} />\r\n\r\n\r\n              <Grid container alignItems=\"center\" spacing={4} >\r\n                <Grid item xs={8}> \r\n                  <TextField\r\n                    id=\"publicKey\"\r\n                    name=\"publicKey\"\r\n                    label=\"Klucz Publiczny osoby której udostępniamy dokument\"\r\n                    className={classes.textField}\r\n                    margin=\"none\"\r\n                    onChange={handleChange}\r\n                    value={publicKey}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  <Button variant=\"contained\" color=\"primary\" style={{width:'100%'}} onClick={e => handleShare(document.documentAddress, publicKey)}>\r\n                    Udostępnij\r\n                  </Button> \r\n                </Grid> \r\n              </Grid>\r\n              <Grid container>\r\n                <Grid item xs={12}>\r\n                  <Button variant=\"contained\" color=\"primary\" style={{width:'100%'}} onClick={e => handleDownload(document.link, document.documentAddress, document.name)}>\r\n                    Pobierz\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n\r\n            </React.Fragment>\r\n            :\r\n            <Typography style={{ margin: '10px 0' }} variant=\"body1\">\r\n              Błąd: {error.msg}\r\n            </Typography>\r\n          }\r\n \r\n        </Grid>\r\n      </Grid >\r\n    </Paper>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { forwardRef } from 'react';\r\nimport AddBox from '@material-ui/icons/AddBox';\r\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\r\nimport Check from '@material-ui/icons/Check';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport Clear from '@material-ui/icons/Clear';\r\nimport DeleteOutline from '@material-ui/icons/DeleteOutline';\r\nimport Edit from '@material-ui/icons/Edit';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport Remove from '@material-ui/icons/Remove';\r\nimport SaveAlt from '@material-ui/icons/SaveAlt';\r\nimport Search from '@material-ui/icons/Search';\r\nimport ViewColumn from '@material-ui/icons/ViewColumn';\r\n\r\nconst tableIcons = {\r\n  Add: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\r\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\r\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n  Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\r\n  DetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\r\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\r\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\r\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\r\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\r\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\r\n  PreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\r\n  SortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\r\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\r\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />)\r\n};\r\n\r\nexport default tableIcons;","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React from 'react';\r\nimport Link from '@material-ui/core/Link';\r\nimport { makeStyles } from '@material-ui/core/styles'; \r\nimport TextField from '@material-ui/core/TextField';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport tableIcons from './tableIcons';\r\n\r\nimport Title from './Title';\r\nimport { CircularProgress, Fade, Typography, Paper, Button, IconButton } from '@material-ui/core'; \r\nimport MaterialTable from 'material-table';\r\nimport { useSnackbar } from 'notistack';\r\n\r\n\r\n \r\nconst useStyles = makeStyles(theme => ({\r\n  seeMore: {\r\n    marginTop: theme.spacing(3),\r\n  },\r\n  link: {\r\n    padding: \"0 0.5rem\",\r\n    cursor: \"pointer\"\r\n  },\r\n  textField: {\r\n    width: '50%',\r\n    margin: '0',\r\n  },\r\n  fetchingDataFromBlockchain: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper:{\r\n    padding: theme.spacing(4),\r\n    marginBottom: theme.spacing(1),\r\n    display: 'flex',\r\n    overflow: 'auto',\r\n    flexDirection: 'column'\r\n  }\r\n}));\r\n\r\n\r\nexport default function FileTableView(props) {\r\n  const {\r\n    setDocument,\r\n    fetchingDocuments,\r\n    rows,\r\n    handleShare,\r\n    handleDownload,\r\n    fileExplorerComponentMounted,\r\n    web3Manager,\r\n    refreshDocuments} = props;\r\n\r\n  const classes = useStyles(); \r\n  const snackbar = useSnackbar();\r\n \r\n  const [publicKey, setPublicKey] = React.useState('');\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if (inputName === 'publicKey') {\r\n      setPublicKey(event.target.value);\r\n    }\r\n  };\r\n\r\n  if(!fileExplorerComponentMounted){ \r\n    return (\r\n\r\n      <Fade in timeout={1000}>\r\n        <Paper className={classes.paper}>\r\n          <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\r\n            <Typography gutterBottom className={classes.connectServerText}>\r\n              Wczytywanie dokumentów...\r\n              </Typography>\r\n            <CircularProgress />\r\n          </Grid>\r\n        </Paper>\r\n      </Fade> \r\n    );\r\n  }\r\n\r\n  const handleDownloadDocuments = async (context, documents) => {\r\n    console.log(\"download documents\", documents); \r\n    snackbar.enqueueSnackbar(`Zostanie pobranych ${documents.length} dokumentów.`, { variant: 'info' });\r\n    const downloadDocumentsPromises = documents.map((doc) => new Promise((resolve, reject) => { \r\n      handleDownload(doc.link, doc.documentAddress, doc.name).then(resolve).catch(reject);\r\n    }))\r\n    try{ \r\n      const downloadResult = await Promise.all(downloadDocumentsPromises);\r\n      const failedDocs = downloadResult.filter((elem) => elem === false);\r\n      if(failedDocs.length > 0){  \r\n        snackbar.enqueueSnackbar('Nie udało się pobrać '+failedDocs.length+' dokumentów', { variant: 'error' });\r\n      } else{\r\n        snackbar.enqueueSnackbar(`Pomyślnie pobrano ${documents.length} dokumentów.`, { variant: 'success' });\r\n      }  \r\n    }catch(err){ \r\n      console.error(err); \r\n    }\r\n  }\r\n  const handleShareDocuments = async (context, documents) => {\r\n    console.log(\"share documents\", documents); \r\n    try{ \r\n      if(!web3Manager.isValidPublicKey(publicKey)){\r\n        throw new Error(\"Nieprawidłowy klucz publiczny do udostępnienia.\")\r\n      }\r\n      snackbar.enqueueSnackbar(`Zostanie udostępnionych ${documents.length} dokumentów.`, { variant: 'info' });\r\n  \r\n      const shareDocumentsPromises = documents.map((doc) => new Promise((resolve, reject) => { \r\n        handleShare(doc.documentAddress, publicKey).then(resolve).catch(reject);\r\n      }))\r\n      const shareResult = await Promise.all(shareDocumentsPromises);\r\n      const failedDocs = shareResult.filter((elem) => elem === false);\r\n      if(failedDocs.length > 0){  \r\n        snackbar.enqueueSnackbar('Nie udało się udostępnić '+failedDocs.length+' dokumentów', { variant: 'error' });\r\n      } else{\r\n\r\n        snackbar.enqueueSnackbar(`Pomyślnie udostępniono ${documents.length} dokumentów.`, { variant: 'success' });\r\n      } \r\n    }catch(err){ \r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się udostępnić dokumentów: ' + err.message, { variant: 'error' });\r\n    }\r\n\r\n  }\r\n\r\n  return (\r\n        <React.Fragment> \r\n          \r\n          <Paper className={classes.paper} > \r\n            <Grid item xs={12}>\r\n              <Title>\r\n                Dane do udostępnienia\r\n              </Title>\r\n              <TextField\r\n                style={{width:'100%'}}\r\n                id=\"publicKey\"\r\n                name=\"publicKey\"\r\n                label=\"Klucz Publiczny osoby której udostępniamy dokument\"\r\n                className={classes.textField}\r\n                margin=\"none\"\r\n                onChange={handleChange}\r\n                value={publicKey}\r\n              />\r\n\r\n            </Grid>\r\n          </Paper>\r\n\r\n          <MaterialTable\r\n              columns={[\r\n                { title: \"Nazwa Pliku\", field: \"name\", render: (row) => { \r\n                  return (\r\n                    <Link color=\"primary\" className={classes.link} onClick={ e => {\r\n                      e.preventDefault();\r\n                      setDocument(row)\r\n                    }}>\r\n                      {row.name}\r\n                    </Link>\r\n                  ) \r\n                } },\r\n                { title: \"Data podpisania\", field: \"date\", defaultSort: \"desc\", customSort: (a, b) => a.timestamp - b.timestamp }\r\n              ]}\r\n              data={rows}\r\n              icons={tableIcons}\r\n              title={(\r\n                <Grid container alignItems=\"center\">\r\n                  <Grid item>\r\n                    <Title>\r\n                      Dokumenty\r\n                    </Title>\r\n                  </Grid>\r\n                  <Grid item style={{marginTop:'-2px'}}>\r\n                    <IconButton onClick={refreshDocuments}>\r\n                      <RefreshIcon/>\r\n                    </IconButton>\r\n                  </Grid>\r\n                </Grid>\r\n              )}\r\n              actions={[\r\n                {\r\n                  icon: () => <ShareIcon/>,\r\n                  tooltip: 'Udostępnij',\r\n                  onClick: handleShareDocuments\r\n                },\r\n                {\r\n                  icon: () => <GetAppIcon/>,\r\n                  tooltip: 'Pobierz',\r\n                  onClick: handleDownloadDocuments\r\n                }\r\n              ]} \r\n              // onSelectionChange={handleSelectionChange}\r\n              options={{\r\n                filtering: false,\r\n                sorting: true,\r\n                grouping: false,\r\n                draggable: false,\r\n                paging: true,\r\n                pageSize: 5,\r\n                pageSizeOptions: [5, 10, 25, 50, 100],\r\n                selection: true,\r\n                actionsColumnIndex: -1\r\n              }} \r\n              localization={{\r\n                body:{\r\n                  emptyDataSourceMessage: fetchingDocuments ? \"Wczytywanie dokumentów...\":\"Brak dokumentów.\"\r\n                }\r\n              }}\r\n            />\r\n\r\n          \r\n          \r\n        </React.Fragment>\r\n        \r\n  );\r\n}\r\n","export default (theme) => ({ \r\n    seeMore: {\r\n        marginTop: theme.spacing(3),\r\n      },\r\n      link: {\r\n        padding: \"0 0.5rem\"\r\n      },\r\n      textField: {\r\n        width: '50%',\r\n        margin: '0',\r\n      },\r\n      fetchingDataFromBlockchain: {\r\n        marginTop: theme.spacing(3)\r\n      }\r\n  });\r\n  ","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useSnackbar } from 'notistack';\r\nimport Axios from 'axios';\r\nimport config from '../config.json';\r\nimport { saveAs } from 'file-saver';\r\nimport { Exception } from 'handlebars';\r\nimport DocumentView from '../views/DocumentView'\r\nimport FileTable from '../views/FileTableView'\r\nimport FileExplorerStyles from '../styles/FileExplorer';\r\nimport EthCrypto from 'eth-crypto';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier.js';\r\nimport encryption from '../helpers/encryption.js';\r\nimport toBuffer from 'blob-to-buffer';\r\n\r\n// Generate Order Data\r\nfunction createData(name, shortDescription, date, link, documentAddress, notaryPublishedBy, timestamp) {\r\n  return { name, shortDescription, date, link, documentAddress, notaryPublishedBy, timestamp};\r\n}\r\n\r\nconst useStyles = makeStyles(FileExplorerStyles);\r\nconst pageSize = 10;\r\n\r\nexport default function FileExplorer(props) {\r\n  const { setLoading, web3Manager, selectedAddress} = props;\r\n\r\n\r\n  const snackbar = useSnackbar();\r\n  const [selectedDocument, setDocument] = React.useState(undefined);\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false);\r\n  const [fetchingDocuments, setFetchingDocuments] = React.useState(false);\r\n  const [componentMounted, setComponentMounted] = React.useState(false); \r\n  const [uniqueDocuments, setUniqueDocuments] = React.useState([]); \r\n  const [rows, setRows] = React.useState([]); \r\n\r\n  const refreshDocuments = () => {\r\n    setRows([]);\r\n    updateUniqueDocuments();\r\n  }\r\n  React.useEffect(() => { \r\n    refreshDocuments();\r\n  }, [selectedAddress]);\r\n\r\n  React.useEffect(() => {\r\n    if (uniqueDocuments.length > 0) {\r\n      getFilesData();\r\n    }\r\n  }, [uniqueDocuments]);\r\n\r\n  const loadDocuments = async (startingIndex, count) => {\r\n    if (startingIndex >= uniqueDocuments.length) {\r\n      throw new Exception(\"Brak dokumentów do załadowania.\");\r\n    }\r\n\r\n    const fetchAllDocuments = uniqueDocuments.slice(startingIndex, startingIndex + count).map((documentAddress) => {\r\n      return new Promise(async (resolve, reject) => {\r\n        try {\r\n          const documentContractCloned = web3Manager.documentContract.clone();\r\n          documentContractCloned.options.address = documentAddress;\r\n\r\n          let title = await documentContractCloned.methods.title().call();\r\n          let ipfsHash = await documentContractCloned.methods.ipfsHash().call();\r\n          let createdAt = await documentContractCloned.methods.createdAt().call();\r\n          let notaryPublishedBy = await documentContractCloned.methods.notaryPublishedBy().call();\r\n          var date = new Date(createdAt * 1000);\r\n          return resolve(createData(title, \"Umowa\", date.toLocaleString(), ipfsHash, documentAddress, notaryPublishedBy, createdAt));\r\n        } catch (err) {\r\n          return reject(err);\r\n        }\r\n      })\r\n\r\n    })\r\n    const allDocuments = await Promise.all(fetchAllDocuments);\r\n    console.log('rows', allDocuments);\r\n    return allDocuments;\r\n  }\r\n\r\n  const getFilesData = async () => {\r\n    console.log('Fetching documents allowed for address:', selectedAddress)\r\n    try {\r\n      setFetchingDocuments(true);\r\n      setLoading(true);\r\n      const pages = Math.ceil(uniqueDocuments.length / pageSize);\r\n      let currentPage = 0;\r\n      const totalDocuments = [];\r\n      while(currentPage < pages){\r\n        \r\n        setLoading(true);\r\n        try{ \r\n          const documents = await loadDocuments(totalDocuments.length, pageSize);\r\n          console.log('documents', documents);\r\n          totalDocuments.push(...documents);\r\n          setRows([...totalDocuments]);\r\n          currentPage++;\r\n        } catch (err) {\r\n          console.error(err);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się odczytać dokumentów: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n      setFetchingDocuments(false);\r\n    }\r\n  }\r\n\r\n  const updateUniqueDocuments = async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const result = await web3Manager.documentManagerContract.methods.getDocuments(selectedAddress).call();\r\n      console.log('documents for address', selectedAddress, result);\r\n      const uniqueDocumentsFromBlockchain = [...new Set(result)].reverse();\r\n      setUniqueDocuments(uniqueDocumentsFromBlockchain);\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się wczytać dokumentów do których masz dostęp: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n      setComponentMounted(true);\r\n    }\r\n  }\r\n\r\n  const handleShare = async (documentAddress, targetPublicKey) => {\r\n    try {\r\n      if(!web3Manager.isValidPublicKey(targetPublicKey)){\r\n        throw new Error(\"Nieprawidłowy klucz publiczny do udostępnienia.\")\r\n      }\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      console.log(\"Share document \", documentAddress, \" to \", targetPublicKey);\r\n      const documentContractCloned = web3Manager.documentContract.clone();\r\n      documentContractCloned.options.address = documentAddress;\r\n      // deszyfrujemy i szyfrujemy ...\r\n\r\n      \r\n      let accountEncryptedKeySimplified = await documentContractCloned.methods.decryptionKeys(web3Manager.selectedAddress).call();\r\n      console.log('not encrypted', accountEncryptedKeySimplified)\r\n      //accountEncryptedKeySimplified = \"3eb7acecdec7cda2a9ab0f773919e3bd031c8b3ff23d398b4afa52c0b28fe9862d5b5419cc3418846677f14e285ef1ab0e4d77e81998657ec07bbbd9aef95844f4a0c24ac6add144c8cc82344caa63641f6a4b9aac4e2d19d024522f4107e2395aa552b3a60c3b3a10d03e38421af4274c08658f846a3c61918e9071af57927f6689e41662f1735d87cfd4d7c7d3126377428d123f107d44a412fada223aac17d5\";\r\n      const accountEncryptedKey = EthCrypto.cipher.parse(accountEncryptedKeySimplified);\r\n      console.log(\"accountEncryptedKey\", accountEncryptedKey);\r\n      const accountDecryptedKey = await EthCrypto.decryptWithPrivateKey(\r\n        web3Manager.getPrivateKeyForSelectedAddress(),\r\n        accountEncryptedKey\r\n      );\r\n      console.log(\"acountDecryptedKey\", accountDecryptedKey);\r\n      const toShareEncryptedKey = await EthCrypto.encryptWithPublicKey(\r\n        targetPublicKey,\r\n        accountDecryptedKey\r\n      );\r\n      console.log(\"encrypted\", toShareEncryptedKey);\r\n      console.log(\"encrypted Siplified\", EthCrypto.cipher.stringify(toShareEncryptedKey))\r\n      const targetAddress = EthCrypto.publicKey.toAddress(targetPublicKey);\r\n\r\n      const deploymentPromiEvent = web3Manager.addPermission(targetAddress, EthCrypto.cipher.stringify(toShareEncryptedKey), documentAddress);\r\n      console.log(\"deploymentPromiEvent\");\r\n      const miningStatus = await notifyOnMiningStatus(deploymentPromiEvent, snackbar, 'Udostępnianie dokumentu');\r\n      console.log('mining status', miningStatus); \r\n      return true;\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się udostępnić dokumentu: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n      setSubmitInProgress(false);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  const handleDownload = async (ipfsHash, documentAddress, title) => { \r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n\r\n      const documentContractCloned = web3Manager.documentContract.clone();\r\n      documentContractCloned.options.address = documentAddress;\r\n      let keySimplified = await documentContractCloned.methods.decryptionKeys(web3Manager.selectedAddress).call();\r\n      const key = EthCrypto.cipher.parse(keySimplified); \r\n      const decryptedKey = await EthCrypto.decryptWithPrivateKey(\r\n        web3Manager.getPrivateKeyForSelectedAddress(),\r\n        key\r\n      ); \r\n      let encryptedDocument\r\n      if(!config.includeNotaryPanel){\r\n        const axiosInstance = Axios.create({withCredentials: false});\r\n        encryptedDocument = await axiosInstance.get(`${config.publicIpfsGateway}/${ipfsHash}`, { responseType: 'blob', timeout: config.ipfsDownloadTimeout});\r\n      } else {\r\n        encryptedDocument = await Axios.get(`${config.ipfsGateway}/${ipfsHash}`, { responseType: 'blob', timeout: config.ipfsDownloadTimeout}); \r\n      }\r\n      const contentArrayBuffer = await new Promise((resolve, reject) => {\r\n        try{ \r\n          toBuffer(encryptedDocument.data, (err, buffer) => {\r\n            if (err) throw err\r\n            return resolve(buffer);\r\n          });\r\n        }catch(err){\r\n          return reject(err);\r\n        }\r\n      })  \r\n      const decryptedContent = encryption.decrypt(contentArrayBuffer, decryptedKey);\r\n\r\n      const blob = new Blob([decryptedContent], {\r\n        type: 'application/pdf',\r\n      }); \r\n      saveAs(blob, title + \".pdf\");\r\n      return true;\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się pobrać dokumentu: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n      setSubmitInProgress(false);\r\n    } \r\n    return false;\r\n  }\r\n  \r\n \r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n\r\n      {!selectedDocument ?\r\n        <FileTable {...props}\r\n          refreshDocuments={refreshDocuments}\r\n          fileExplorerComponentMounted={componentMounted} \r\n          setDocument={setDocument}\r\n          fetchingDocuments={fetchingDocuments} \r\n          rows={rows}\r\n          handleShare={handleShare}\r\n          handleDownload={handleDownload} \r\n          web3Manager={web3Manager}\r\n        />\r\n        :\r\n        <DocumentView {...props}\r\n          document={selectedDocument}\r\n          setDocument={setDocument}\r\n          handleShare={handleShare} \r\n          handleDownload={handleDownload}\r\n          web3Manager={web3Manager}\r\n          setLoading={setLoading}\r\n        />\r\n      }</React.Fragment>\r\n  );\r\n}\r\n","import React from 'react';  \r\nimport { Grid, Paper, Fade, Typography } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport homeStyles from '../styles/Home';\r\nimport FileExplorer from './FileExplorer'; \r\n\r\nconst useStyles = makeStyles(homeStyles);\r\n\r\nexport default function Home(props) {\r\n  const {setLoading, selectedAddress, web3Manager} = props;\r\n  const classes = useStyles();  \r\n  if(!selectedAddress) {\r\n    return (\r\n      <Fade in timeout={1000}> \r\n        <Paper className={classes.paper}>\r\n          <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\r\n            <Typography gutterBottom className={classes.connectServerText}>\r\n              Wymagane podłączenie konta poprzez Web3. Sugerujemy wykorzystanie rozszerzenia do przeglądarki MetaMask.\r\n            </Typography>\r\n          </Grid>\r\n        </Paper>\r\n      </Fade> \r\n    )\r\n  }\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FileExplorer web3Manager={web3Manager} setLoading={setLoading} selectedAddress={selectedAddress}/>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n ","export default (theme) => ({ \r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    display: 'flex',\r\n    overflow: 'auto',\r\n    flexDirection: 'column',\r\n  }\r\n});\r\n","import React from 'react';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button } from '@material-ui/core';\r\nimport AddDocumentStyles from '../styles/AddDocument';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier';\r\nimport axios from 'axios';\r\nimport config from '../config.json';\r\nimport EthCrypto from 'eth-crypto';\r\n\r\n\r\nconst useStyles = makeStyles(AddDocumentStyles);\r\n\r\nexport default function AddDocumentForm(props) {\r\n  const { web3Manager, setLoading } = props;\r\n  const snackbar = useSnackbar();\r\n  const classes = useStyles();\r\n\r\n  const [file, setFile] = React.useState(null);\r\n  const [fileName, setFileName] = React.useState(\"Upload File\");\r\n  const [title, setTitle] = React.useState('');\r\n\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false); \r\n\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if (inputName === 'title') {\r\n      setTitle(event.target.value);\r\n    }\r\n    if (inputName === 'document') {\r\n      if (event.target.files.length > 0) {\r\n        setFile(event.target.files[0])\r\n        setFileName(event.target.files[0].name)\r\n      }\r\n      else {\r\n        setFileName(\"Upload File\")\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      let formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      const result = await axios.post(`${config.apiUrl}/publishFile`, formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data'\r\n          }\r\n        });\r\n      const ipfsHash = result.data.hash;\r\n      const myEncryptionKey = result.data.key;\r\n      console.log(ipfsHash);\r\n      console.log('myEncryptionKey', myEncryptionKey); \r\n       \r\n      const myEncryptedKey = await EthCrypto.encryptWithPublicKey(\r\n        web3Manager.getPublicKeyForSelectedAddress(), // encrypt with alice's publicKey\r\n        myEncryptionKey\r\n      );\r\n\r\n      const myEncryptedKeyAsString = EthCrypto.cipher.stringify(myEncryptedKey);\r\n      const deploymentPromiEvent = web3Manager.addDocument(title, ipfsHash, myEncryptedKeyAsString);\r\n\r\n      const miningStatus = await notifyOnMiningStatus(deploymentPromiEvent, snackbar, 'Nowy dokument');\r\n      console.log('mining status', miningStatus);\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się dodać dokumentu: ' + err.message, { variant: 'error' });\r\n    } finally {\r\n      setLoading(false);\r\n      setSubmitInProgress(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Grid item xs={12}>\r\n      <Paper className={classes.paper}>\r\n        <Title>\r\n          Dodaj nowy dokument\r\n        </Title>\r\n        <Typography variant=\"body1\">\r\n          Nadaj tytuł oraz wybierz plik w formacie PDF.\r\n        </Typography>\r\n        <div className={classes.textFieldRoot}>\r\n          <Grid container spacing={3}>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                id=\"title\"\r\n                name=\"title\"\r\n                label=\"Tytuł\"\r\n                className={classes.textField}\r\n                margin=\"normal\"\r\n                onChange={handleChange}\r\n                value={title}\r\n                inputProps={{autoComplete: \"off\"}}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <Button\r\n                variant=\"contained\"\r\n                component=\"label\"\r\n                className={classes.uploadButton}\r\n              >\r\n                {fileName}\r\n                <input\r\n                  id=\"document\"\r\n                  name=\"document\"\r\n                  type=\"file\"\r\n                  style={{ display: \"none\" }}\r\n                  onChange={handleChange} \r\n                />\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </div>\r\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleSubmit} disabled={submitInProgress}>\r\n          Dodaj\r\n        </Button>\r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper } from '@material-ui/core';\r\nimport AddDocumentStyles from '../styles/AddDocument';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport AddDocumentForm from '../views/AddDocumentForm'\r\nimport Title from '../views/Title';\r\n\r\nconst useStyles = makeStyles(AddDocumentStyles);\r\n\r\nexport default function AddDocument(props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <Paper className={classes.paper}>\r\n          <Title>\r\n            Dodaj dokument\r\n          </Title>\r\n          <Typography variant=\"body1\">\r\n            Na tej stronie jako notariusz mozesz dodać dokument.\r\n          </Typography> \r\n\r\n        </Paper>\r\n      </Grid>\r\n      <AddDocumentForm web3Manager={props.web3Manager} setLoading={props.setLoading}/> \r\n    </Grid>\r\n  );\r\n}\r\n ","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nexport default function Error404(props) {\r\n  return (\r\n    <Typography component=\"h2\" variant=\"h6\" color=\"primary\" gutterBottom> \r\n      Ta strona nie istnieje.\r\n    </Typography>\r\n  );\r\n}\r\n ","export default (theme) => ({ \r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    display: 'flex',\r\n    overflow: 'auto',\r\n    flexDirection: 'column',\r\n  },\r\n  textFieldRoot: { \r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  textField: {\r\n    width: '100%',\r\n  },\r\n});\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport axios from 'axios';\r\nimport loginStyles from '../styles/Login';\r\nimport config from '../config.json';\r\nimport { useSnackbar } from 'notistack';\r\n\r\nconst useStyles = makeStyles(loginStyles);\r\n\r\nexport default function Login(props) {\r\n  \r\n  const snackbar = useSnackbar();\r\n  const [password, setPassword] = React.useState('');\r\n  const [loginInProgress, setLoginInProgress] = React.useState(false);\r\n  const classes = useStyles(); \r\n  const handleChange = event => {\r\n    setPassword(event.target.value);\r\n  };\r\n  const handleLogin = async () => {\r\n    let result;\r\n    try{\r\n      props.setLoading(true);\r\n      setLoginInProgress(true);\r\n      result = await axios.post(`${config.apiUrl}/login`, {login: 'admin', password}); \r\n    } catch(err) { \r\n      if(err.response && err.response.data && err.response.data.message){\r\n        return snackbar.enqueueSnackbar(err.response.data.message, {variant:'error'});\r\n      }\r\n      snackbar.enqueueSnackbar(`Wystąpił błąd podczas logowania: ${err.message}`, {variant:'error'});\r\n    } finally{\r\n      setLoginInProgress(false);\r\n      props.setLoading(false);\r\n    }\r\n    if(result && result.data && result.data.success){\r\n      props.setLoggedIn(true);\r\n    }\r\n  }\r\n\r\n  \r\n  React.useEffect(() => {\r\n    if(!config.includeNotaryPanel){\r\n      console.log(\"Do not include Notary Panel - omitting Login page\")\r\n      props.setLoggedIn(true);\r\n    }\r\n  }, []);\r\n\r\n  \r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <Paper className={classes.paper}>\r\n          <Typography variant=\"h6\" color=\"primary\" gutterBottom>\r\n            Zaloguj się do systemu\r\n          </Typography>\r\n          <Typography variant=\"body1\">\r\n            Aby uzyskać dostęp do panelu notariusza należy podać hasło ustawione podczas uruchamiania serwera.\r\n          </Typography>\r\n          <div className={classes.textFieldRoot}> \r\n            <TextField\r\n              onKeyPress={(ev) => { \r\n                if (ev.key === 'Enter') { \r\n                  ev.preventDefault();\r\n                  handleLogin()\r\n                }\r\n              }}\r\n              id=\"server-password\"\r\n              label=\"Hasło\"\r\n              className={classes.textField}\r\n              type=\"password\"\r\n              autoComplete=\"current-password\"\r\n              margin=\"normal\"\r\n              onChange={handleChange}\r\n              value={password}\r\n              autoFocus\r\n            />\r\n          </div>\r\n          <Button variant=\"contained\" color=\"primary\" onClick={handleLogin} disabled={loginInProgress}>\r\n            Zaloguj\r\n          </Button>\r\n        </Paper>\r\n      </Grid>\r\n    </Grid>\r\n    \r\n  );\r\n}\r\n\r\nLogin.propTypes = {\r\n  setLoggedIn: PropTypes.func.isRequired,\r\n};\r\n","import Web3 from 'web3';\r\nimport HDWalletProvider from \"@truffle/hdwallet-provider\";\r\nimport NotaryManager from '../smartContracts/NotaryManager.json'; \r\nimport DocumentManager from '../smartContracts/DocumentManager.json'; \r\nimport Document from '../smartContracts/Document.json'; \r\nimport Notary from '../smartContracts/Notary.json'; \r\nimport config from '../config.json'; \r\nimport EthCrypto from 'eth-crypto';\r\nconst bip39 = require('bip39'); \r\n\r\nclass Web3Manager {\r\n  constructor(){\r\n    window.web3Manger = this;\r\n    this.web3 = null;\r\n    \r\n    this.notaryManagerContract = null;\r\n    this.documentManagerContract = null;\r\n    this.notaryContract = null;\r\n    this.documentContract = null;\r\n\r\n    this.selectedAddress = null;\r\n    this.accountChangeListeners = [];\r\n  }\r\n \r\n  fromWei(wei, unit){\r\n    return this.web3.utils.fromWei(wei, unit);\r\n  }\r\n\r\n  isValidAddress(address){\r\n    return this.web3.utils.isAddress(address);\r\n  }\r\n  isValidPublicKey(pubKey){\r\n    try{\r\n      const address = EthCrypto.publicKey.toAddress(pubKey);\r\n      return this.isValidAddress(address);\r\n    }catch(err){\r\n      return false;\r\n    } \r\n  }\r\n\r\n\r\n  async updateSelectedAccount(accountInfo){\r\n    if(accountInfo.selectedAddress === this.selectedAddress){\r\n      return;\r\n    }\r\n    this.selectedAddress = accountInfo.selectedAddress; \r\n    this.accountChangeListeners.forEach((callback) => callback(this.selectedAddress));\r\n  }\r\n\r\n  getPublicKeyForSelectedAddress(){ \r\n    const wallet = this.web3.currentProvider.wallets[this.selectedAddress];\r\n    return wallet.pubKey.toString(\"hex\")\r\n  }\r\n\r\n  getPrivateKeyForSelectedAddress(){ \r\n    const wallet = this.web3.currentProvider.wallets[this.selectedAddress];\r\n    return wallet.privKey.toString(\"hex\")\r\n  }\r\n\r\n  async getCurrentBalance(){\r\n    return this.web3.eth.getBalance(this.selectedAddress);\r\n  }\r\n  onAccountChange(callback){\r\n    this.accountChangeListeners.push(callback);\r\n  }\r\n \r\n  generateMnemonic(){\r\n    // const bip39 = require('bip39');\r\n    console.log(\"bip\", bip39)\r\n    return bip39.generateMnemonic()\r\n  }\r\n\r\n  async initWeb3Manager(mnemonic){  \r\n    console.log('Using infura as web3 provider.', mnemonic);\r\n    this.web3 = new Web3(\r\n      new HDWalletProvider(mnemonic, 'https://ropsten.infura.io/v3/2110b3b8a5974c83a3bff2c3a4cb0527')\r\n    );\r\n       \r\n    window.web3 = this.web3; \r\n    this.selectedAddress = this.web3.currentProvider.addresses[0];\r\n\r\n    \r\n    this.notaryManagerContract = new this.web3.eth.Contract(NotaryManager.abi, config.notaryManagerAddress);\r\n    this.documentManagerContract = new this.web3.eth.Contract(DocumentManager.abi, config.documentManagerAddress);\r\n    this.documentContract = new this.web3.eth.Contract(Document.abi);\r\n    this.notaryContract = new this.web3.eth.Contract(Notary.abi); \r\n  }\r\n\r\n  async isNotary() {\r\n    return await this.notaryManagerContract.methods.isNotary(this.selectedAddress).call(); \r\n  }\r\n\r\n  async isOwner() {\r\n    return await this.notaryManagerContract.methods.isOwner().call({from: this.selectedAddress}); \r\n  }\r\n  \r\n  /**\r\n   * \r\n   * @param {String} name \r\n   * @param {String} surname \r\n   * @param {Address} publicKey \r\n   * @param {String} officeLocation \r\n   * @returns {PromiEvent} promiEvent\r\n   */\r\n  deployNotary(name, surname, publicKey, officeLocation){\r\n    return this.notaryContract.deploy({\r\n        data: Notary.bytecode,\r\n        arguments: [name, surname, publicKey, officeLocation]\r\n      }).send({\r\n        from: this.selectedAddress\r\n      });\r\n  }\r\n  addNotary(contractAddress){\r\n    return this.notaryManagerContract.methods.addNotary(contractAddress).send({\r\n      from: this.selectedAddress\r\n    });\r\n  }\r\n  updateNotary(contractAddress, method, value){\r\n    const notaryContractCloned = this.notaryContract.clone();\r\n    notaryContractCloned.options.address = contractAddress; \r\n    return notaryContractCloned.methods[method](value).send({\r\n      from: this.selectedAddress\r\n    }); \r\n  }\r\n  removeNotary(notaryPublicKey){\r\n    return this.notaryManagerContract.methods.removeNotary(notaryPublicKey).send({\r\n      from: this.selectedAddress\r\n    });\r\n  }\r\n  addDocument(title, ipfsHash, myEncryptedKey){\r\n    return this.documentManagerContract.methods.addDocument(title, ipfsHash, myEncryptedKey ).send({\r\n      from: this.selectedAddress\r\n    });\r\n  }\r\n  getDocuments(address){\r\n    return this.documentManagerContract.methods.getDocuments(address).call()\r\n  }\r\n  addPermission(account, accountEncryptedKey, document){\r\n    return this.documentManagerContract.methods.addPermission(account, accountEncryptedKey, document).send({\r\n      from: this.selectedAddress\r\n    });\r\n  }\r\n\r\n  async listAllNotaries(){\r\n    \r\n    // this.notaryManagerContract.NotaryStatusChange({}, { fromBlock: 0, toBlock: 'latest' }).get((error, eventResult) => {\r\n    //   if (error)\r\n    //     console.log('Error in myEvent event handler: ' + error);\r\n    //   else\r\n    //     console.log('myEvent: ' + JSON.stringify(eventResult.args));\r\n    // });\r\n    const notaryStatusChangeRawEvents = await this.notaryManagerContract.getPastEvents(\"NotaryStatusChange\", {fromBlock: 0});\r\n    const notaryStatusChangeEvents = notaryStatusChangeRawEvents.map((event) => ({notaryPublicKey: event.returnValues[0], status: event.returnValues[1], block: event.blockNumber}))\r\n    const notariesStatuses = {};\r\n    notaryStatusChangeEvents.forEach((event) => {\r\n      notariesStatuses[event.notaryPublicKey] = event;\r\n    })\r\n    const listOfAllNotaries = Object.keys(notariesStatuses).map((notaryStatus) => ({\r\n      notaryPublicKey: notariesStatuses[notaryStatus].notaryPublicKey, \r\n      block: notariesStatuses[notaryStatus].block, \r\n      status: notariesStatuses[notaryStatus].status === \"0\" ? \"Aktywny\" : \"Zablokowany\"\r\n    }))\r\n    \r\n    return listOfAllNotaries;\r\n  }\r\n\r\n} \r\nexport default new Web3Manager();\r\n ","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { Fragment } from 'react';  \r\nimport { Grid, Paper, Fade, Typography, CircularProgress, Button, TextField } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport dashboardStyles from '../styles/Dashboard'; \r\nimport web3Manager from '../helpers/web3Manager';\r\nimport { useSnackbar } from 'notistack';\r\n\r\nconst useStyles = makeStyles(dashboardStyles);\r\n\r\nexport default function Web3Provider(props) {\r\n  const {setLoading, setNotaryManager, setNotary, setAccountSelected} = props;//\r\n  const classes = useStyles();  \r\n  const snackbar = useSnackbar();\r\n\r\n  const [mnemonic, setMnemonic] = React.useState(\"\");\r\n  const [web3Initialised, setWeb3Initialized] = React.useState(false);\r\n  const [web3FailedInitialization, setWeb3FailedInitialization] = React.useState(false);\r\n\r\n  const [selectedAddress, setSelectedAddress] = React.useState(null);\r\n\r\n\r\n  const updateAccountSelected = async (address) => {\r\n    console.log(\"Update current selected address:\", address);\r\n    setSelectedAddress(address);\r\n    setNotary(await web3Manager.isNotary());\r\n    setNotaryManager(await web3Manager.isOwner());\r\n  } \r\n  \r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if(inputName === 'mnemonic'){\r\n      setMnemonic(event.target.value);\r\n    } \r\n  };\r\n\r\n  \r\n  // const waitForWeb3 =  async () => {\r\n  //   setLoading(true);\r\n  //   setWeb3FailedInitialization(false);\r\n  //   try{\r\n  //     await web3Manager.initializing;\r\n  //     setWeb3Initialized(true);\r\n\r\n  //     await updateAccountSelected(web3Manager.selectedAddress);\r\n      \r\n  //     setLoading(false);\r\n  //   }catch(err){\r\n  //     console.error(err);\r\n  //     setWeb3FailedInitialization(true);\r\n  //     snackbar.enqueueSnackbar(\"Nie udało się połączyć z Web3. \" + err.message, {variant:'error'});\r\n  //     setLoading(false);\r\n  //   } \r\n  // };\r\n\r\n  // React.useEffect(() => {\r\n  //   web3Manager.onAccountChange(updateAccountSelected);\r\n  //   waitForWeb3()\r\n  // }, []); \r\n\r\n  const handleLogin = async () => {\r\n    try{\r\n      if(mnemonic.length === 0){\r\n        return snackbar.enqueueSnackbar(\"Musisz podac mnemonic wygenerowany przy pierwszym logowaniu\", {variant:'error'});\r\n      }\r\n      await web3Manager.initWeb3Manager(mnemonic);\r\n      await updateAccountSelected(web3Manager.selectedAddress);\r\n      setWeb3Initialized(true);\r\n      setAccountSelected(web3Manager.selectedAddress);\r\n    }catch(err){\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar(\"Nie udało się zalogwoac \" + err.message, {variant:'error'});\r\n    }\r\n    \r\n  }\r\n\r\n  const handleCreateAccount = async () => {\r\n    const newMnemonic = web3Manager.generateMnemonic();\r\n    setMnemonic(newMnemonic);\r\n    snackbar.enqueueSnackbar(\r\n      <Grid container direction=\"column\"> \r\n        <Typography variant=\"body1\" gutterBottom>\r\n          Wygenerowano nowe konto. Pamiętaj aby <b>zapisać</b> mnemonic. Bez niego nie będziesz mógł się zalogować na swoje konto w przyszłości.\r\n        </Typography>\r\n        <Typography variant=\"overline\">\r\n          {newMnemonic}\r\n        </Typography>\r\n      </Grid>, {variant:'success'});\r\n  }\r\n\r\n  if(web3Initialised){ \r\n    return props.render({\r\n      ...props,\r\n      selectedAddress,\r\n      web3Manager \r\n    });\r\n  } \r\n  return (\r\n    <Fade in timeout={1000}> \r\n      <Paper className={classes.paper}>\r\n        <Grid container>\r\n            <Grid item xs={12}>\r\n              <Typography>\r\n                Zaloguj się podajac Mnemonic, ktory wygenerowales podczas pierwszego uzycia aplikacji:\r\n              </Typography>\r\n              <TextField\r\n                id=\"mnemonic\"\r\n                name=\"mnemonic\"\r\n                label=\"Mnemonic (12 slow)\"\r\n                className={classes.textField} \r\n                margin=\"normal\"\r\n                onChange={handleChange}\r\n                value={mnemonic}\r\n                inputProps={{autoComplete: \"off\"}}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <Button variant=\"contained\" color=\"primary\" onClick={handleLogin} className={classes.actionButton}>\r\n                Zaloguj\r\n              </Button>\r\n              <Button variant=\"contained\" onClick={handleCreateAccount} className={classes.actionButton}>\r\n                Utworz nowe konto\r\n              </Button>\r\n            </Grid>\r\n            {web3FailedInitialization && \r\n              <Button variant=\"contained\" >\r\n                Ponów próbę\r\n              </Button>\r\n            }\r\n        </Grid>\r\n      </Paper>\r\n    </Fade> \r\n  )\r\n}\r\n ","export default (theme) => ({ \r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    display: 'flex',\r\n    overflow: 'auto',\r\n    flexDirection: 'column',\r\n  },\r\n  textFieldRoot: { \r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  textField: {\r\n    width: '100%',\r\n  },\r\n  dividerMargin:{\r\n    marginTop: theme.spacing(1),\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  notariesList:{\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(2)\r\n  }\r\n});\r\n","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button, Divider } from '@material-ui/core';\r\nimport notaryManagerStyles from '../styles/NotaryManager';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier';\r\n\r\nconst useStyles = makeStyles(notaryManagerStyles);\r\n\r\nexport default function AddNotaryForm(props) { \r\n  const {web3Manager, setLoading} = props; \r\n  const snackbar = useSnackbar();\r\n  const classes = useStyles();\r\n\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false);\r\n  const [name, setName] = React.useState('');\r\n  const [surname, setSurname] = React.useState('');\r\n  const [publicKey, setPublicKey] = React.useState('');\r\n  const [officeLocation, setOfficeLocation] = React.useState('');\r\n  const [notaryAccount, setNotaryAccount] = React.useState('');\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if(inputName === 'name'){\r\n      setName(event.target.value);\r\n    }\r\n    if(inputName === 'surname'){\r\n      setSurname(event.target.value);\r\n    }\r\n    if(inputName === 'publicKey'){\r\n      setPublicKey(event.target.value);\r\n    }\r\n    if(inputName === 'officeLocation'){\r\n      setOfficeLocation(event.target.value);\r\n    }\r\n    if(inputName === 'notaryAccount'){\r\n      setNotaryAccount(event.target.value);\r\n    }\r\n  };\r\n\r\n  const addNotary = async(notaryContractAddress) => {\r\n    const addNotaryPromiEvent = web3Manager.addNotary(notaryContractAddress) \r\n    const miningStatus = await notifyOnMiningStatus(addNotaryPromiEvent, snackbar, 'Uprawnienia notariusza'); \r\n    console.log('mining status' , miningStatus); \r\n  }\r\n\r\n  const handleSubmit = async() => { \r\n    try{ \r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      const notaryAlreadyExists = await web3Manager.notaryManagerContract.methods.isNotary(publicKey).call();\r\n      if(notaryAlreadyExists){\r\n        throw new Error(\"Istnieje już notariusz o adresie kryptowalutowym: \" + publicKey);\r\n      }\r\n      const deploymentPromiEvent = web3Manager.deployNotary(name, surname, publicKey, officeLocation); \r\n      console.log(deploymentPromiEvent);\r\n      const deployedContract = await notifyOnMiningStatus(deploymentPromiEvent, snackbar, 'Zakładanie konta notariusza');  \r\n      console.log(\"Your contract is under \", deployedContract._address);\r\n      \r\n      //snackbar.enqueueSnackbar(`Utworzono nowe konto notariusza: ${deployedContract._address}`, {variant: 'success'});\r\n      setNotaryAccount(deployedContract._address);\r\n      await addNotary(deployedContract._address)\r\n    }catch(err){\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się dodać notariusza: ' + err.message, {variant: 'error'});\r\n    }finally{\r\n      setLoading(false);\r\n      setSubmitInProgress(false)\r\n    } \r\n  }\r\n\r\n  const grantPrivileges = async () => {\r\n    try{ \r\n      setSubmitInProgress(true);\r\n      setLoading(true); \r\n      await addNotary(notaryAccount)\r\n    }catch(err){\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się nadać uprawnień dla notariusza: ' + err.message, {variant: 'error'});\r\n    }finally{\r\n      setLoading(false);\r\n      setSubmitInProgress(false)\r\n    } \r\n  }\r\n\r\n  return (\r\n    <Grid item xs={12}>\r\n      <Paper className={classes.paper}>\r\n        <Title>\r\n          Dodaj notariusza\r\n        </Title>\r\n        <Typography variant=\"body1\">\r\n          Aby nadać notariuszowi uprawnienia dostępu do systemu należy utworzyć dla niego konto. Każdy z notariuszy reprezentowany jest przez hash. Hash ten może zostać później wykorzystany do odebrania uprawnień lub zmiany informacji o notariuszu.\r\n        </Typography> \r\n        <div className={classes.textFieldRoot}> \r\n          <TextField\r\n            id=\"name\"\r\n            name=\"name\"\r\n            label=\"Imię\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={name} \r\n          />\r\n          <TextField\r\n            id=\"surname\"\r\n            name=\"surname\"\r\n            label=\"Nazwisko\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={surname} \r\n          /> \r\n          <TextField\r\n            id=\"publicKey\"\r\n            name=\"publicKey\"\r\n            label=\"Adres konta notariusza (Zgłoszony przez notariusza - nie ma możliwości późniejszej zmiany)\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={publicKey} \r\n          />\r\n          <TextField\r\n            id=\"officeLocation\"\r\n            name=\"officeLocation\"\r\n            label=\"Adres biura (opcjonalne)\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={officeLocation} \r\n          />\r\n        </div>\r\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleSubmit} disabled={submitInProgress}>\r\n          Dodaj\r\n        </Button>\r\n\r\n        <Divider className={classes.dividerMargin}/>\r\n        <Typography variant=\"body1\">\r\n          Jeżeli notariusz posiada już założone konto, ale nie jest dodany do systemu, możesz nadać mu uprawnienia bezpośrednio podając hash jego konta w polu poniżej.\r\n        </Typography>\r\n        \r\n        <div className={classes.textFieldRoot}> \r\n          <TextField\r\n            id=\"notaryAccount\"\r\n            name=\"notaryAccount\"\r\n            label=\"Hash konta notariusza\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={notaryAccount} \r\n          />\r\n        </div>\r\n          \r\n        <Button variant=\"contained\" color=\"secondary\" onClick={grantPrivileges} disabled={submitInProgress}>\r\n          Nadaj uprawnienia\r\n        </Button>\r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n ","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button, IconButton } from '@material-ui/core';\r\nimport notaryManagerStyles from '../styles/NotaryManager';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier';\r\n\r\nconst useStyles = makeStyles(notaryManagerStyles);\r\n\r\nexport default function EditNotaryForm(props) { \r\n  const {web3Manager, setLoading} = props; \r\n  const classes = useStyles(); \r\n  const snackbar = useSnackbar();\r\n\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false);\r\n  const [notaryPublicKey, setNotaryPublicKey] = React.useState('');\r\n  const [notaryAccountAddress, setNotaryAccountAddress] = React.useState(''); \r\n  const [name, setName] = React.useState('');\r\n  const [surname, setSurname] = React.useState(''); \r\n  const [officeLocation, setOfficeLocation] = React.useState('');\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if(inputName === 'notaryPublicKey'){\r\n      setNotaryPublicKey(event.target.value);\r\n    } \r\n    if(inputName === 'name'){\r\n      setName(event.target.value);\r\n    }\r\n    if(inputName === 'surname'){\r\n      setSurname(event.target.value);\r\n    }\r\n    if(inputName === 'officeLocation'){\r\n      setOfficeLocation(event.target.value);\r\n    }\r\n  };\r\n\r\n  const handleLoadNotary = async () => {\r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      const isNotary = await web3Manager.notaryManagerContract.methods.isNotary(notaryPublicKey).call();\r\n      if(!isNotary){\r\n        return snackbar.enqueueSnackbar('Podany adres kryptowalutowy nie należy do żadnego notariusza w tym systemie.', {variant: 'error'});\r\n      }\r\n      const result = await web3Manager.notaryManagerContract.methods.notaries(notaryPublicKey).call();\r\n      const notaryContractCloned = web3Manager.notaryContract.clone();\r\n      notaryContractCloned.options.address = result; \r\n      setName(await notaryContractCloned.methods.name().call());\r\n      setSurname(await notaryContractCloned.methods.surname().call());\r\n      setOfficeLocation(await notaryContractCloned.methods.officeLocation().call());\r\n      setNotaryAccountAddress(result);\r\n    } catch (err) { \r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się wczytać danych notariusza: ' + err.message, {variant: 'error'});\r\n    } finally {\r\n      setSubmitInProgress(false);\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  const handleUpdateNotary = async (method, value) => {\r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true); \r\n      const updateNotaryPromiEvent = web3Manager.updateNotary(notaryAccountAddress, method, value); \r\n      const miningStatus = await notifyOnMiningStatus(updateNotaryPromiEvent, snackbar, 'Aktualizacja danych notariusza'); \r\n      console.log('mining status' , miningStatus); \r\n    } catch (err) { \r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się zaktualizować danych notariusza: ' + err.message, {variant: 'error'});\r\n    } finally {\r\n      setSubmitInProgress(false);\r\n      setLoading(false);\r\n    }\r\n  }\r\n  return (\r\n    <Grid item xs={6}>\r\n      <Paper className={classes.paper}>\r\n        <Title>\r\n          Edytuj dane notariusza\r\n        </Title>\r\n        <Typography variant=\"body1\">\r\n          W tej sekcji możesz zmienić dane o notariuszu. W tym celu podaj jego adres w polu poniżej, a następnie wczytaj jego profil.\r\n        </Typography>  \r\n        <div className={classes.textFieldRoot}> \r\n          <TextField\r\n            id=\"notaryPublicKey\"\r\n            name=\"notaryPublicKey\"\r\n            label=\"Adres (kryptowalutowy) Notariusza\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={notaryPublicKey} \r\n          />\r\n        </div> \r\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleLoadNotary} disabled={submitInProgress}>\r\n          Wczytaj\r\n        </Button>\r\n        {notaryAccountAddress && \r\n          <div>\r\n            <div className={classes.textFieldRoot}> \r\n              \r\n               \r\n              <Grid container spacing={1} alignItems=\"flex-end\">\r\n                <Grid item style={{flex:1}}>\r\n                  <TextField\r\n                    id=\"name\"\r\n                    name=\"name\"\r\n                    label=\"Imię\"\r\n                    className={classes.textField} \r\n                    margin=\"normal\"\r\n                    onChange={handleChange}\r\n                    value={name} \r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <IconButton onClick = {() => handleUpdateNotary('setName', name)} >\r\n                    <SaveIcon />\r\n                  </IconButton>\r\n                </Grid>\r\n              </Grid> \r\n\r\n              <Grid container spacing={1} alignItems=\"flex-end\">\r\n                <Grid item style={{flex:1}}>\r\n                  <TextField\r\n                    id=\"surname\"\r\n                    name=\"surname\"\r\n                    label=\"Nazwisko\"\r\n                    className={classes.textField} \r\n                    margin=\"normal\"\r\n                    onChange={handleChange}\r\n                    value={surname} \r\n                  />  \r\n                </Grid>\r\n                <Grid item>\r\n                  <IconButton onClick = {() => handleUpdateNotary('setSurname', surname)} >\r\n                    <SaveIcon />\r\n                  </IconButton>\r\n                </Grid>\r\n              </Grid> \r\n\r\n              <Grid container spacing={1} alignItems=\"flex-end\">\r\n                <Grid item style={{flex:1}}>\r\n                  <TextField\r\n                    id=\"officeLocation\"\r\n                    name=\"officeLocation\"\r\n                    label=\"Adres biura (opcjonalne)\"\r\n                    className={classes.textField} \r\n                    margin=\"normal\"\r\n                    onChange={handleChange}\r\n                    value={officeLocation} \r\n                    />\r\n                </Grid>\r\n                <Grid item>\r\n                  <IconButton onClick = {() => handleUpdateNotary('setOfficeLocation', officeLocation)} >\r\n                    <SaveIcon />\r\n                  </IconButton>\r\n                </Grid>\r\n              </Grid> \r\n            </div>   \r\n          </div>\r\n        }\r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n ","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button, IconButton } from '@material-ui/core';\r\nimport notaryManagerStyles from '../styles/NotaryManager';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack';\r\nimport notifyOnMiningStatus from '../helpers/miningStatusNotifier';\r\n\r\nconst useStyles = makeStyles(notaryManagerStyles);\r\n\r\nexport default function DeleteNotaryForm(props) { \r\n  const {web3Manager, setLoading} = props; \r\n  const classes = useStyles(); \r\n  const snackbar = useSnackbar();\r\n\r\n  const [submitInProgress, setSubmitInProgress] = React.useState(false);\r\n  const [notaryPublicKey, setNotaryPublicKey] = React.useState('');\r\n  const [notaryAccountAddress, setNotaryAccountAddress] = React.useState(''); \r\n  const [name, setName] = React.useState('');\r\n  const [surname, setSurname] = React.useState(''); \r\n  const [officeLocation, setOfficeLocation] = React.useState('');\r\n  const handleChange = event => {\r\n    const inputName = event.target.name;\r\n    if(inputName === 'notaryPublicKey'){\r\n      setNotaryPublicKey(event.target.value);\r\n    } \r\n    if(inputName === 'name'){\r\n      setName(event.target.value);\r\n    }\r\n    if(inputName === 'surname'){\r\n      setSurname(event.target.value);\r\n    }\r\n    if(inputName === 'officeLocation'){\r\n      setOfficeLocation(event.target.value);\r\n    }\r\n  };\r\n\r\n  const handleRemoveNotary = async () => {\r\n    try {\r\n      setSubmitInProgress(true);\r\n      setLoading(true);\r\n      const isNotary = await web3Manager.notaryManagerContract.methods.isNotary(notaryPublicKey).call();\r\n      if(!isNotary){\r\n        return snackbar.enqueueSnackbar('Podany klucz publiczny nie należy do żadnego notariusza w tym systemie.', {variant: 'error'});\r\n      }\r\n\r\n      const removeNotaryPromiEvent = web3Manager.removeNotary(notaryPublicKey); \r\n      const miningStatus = await notifyOnMiningStatus(removeNotaryPromiEvent, snackbar, 'Usuwanie notariusza'); \r\n      console.log('mining status' , miningStatus); \r\n \r\n    } catch (err) { \r\n      console.error(err);\r\n      snackbar.enqueueSnackbar('Nie udało się usunąć uprawnień notariusza: ' + err.message, {variant: 'error'});\r\n    } finally {\r\n      setSubmitInProgress(false);\r\n      setLoading(false);\r\n    }\r\n  }\r\n \r\n  return (\r\n    <Grid item xs={6}>\r\n      <Paper className={classes.paper}>\r\n        <Title>\r\n          Usuń notariusza\r\n        </Title>\r\n        <Typography variant=\"body1\">\r\n          Aby odebrać uprawnienia do systemu dla notariusza, należy umieścić w polu poniżej jego adres publiczny, a następnie zapisać zmiany na blockchainie.\r\n        </Typography>  \r\n        <div className={classes.textFieldRoot}> \r\n          <TextField\r\n            id=\"notaryPublicKey\"\r\n            name=\"notaryPublicKey\"\r\n            label=\"Adres (kryptowalutowy) Notariusza\"\r\n            className={classes.textField} \r\n            margin=\"normal\"\r\n            onChange={handleChange}\r\n            value={notaryPublicKey} \r\n          />\r\n        </div> \r\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleRemoveNotary} disabled={submitInProgress}>\r\n          Usuń uprawnienia\r\n        </Button>\r\n         \r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n ","import React, { useState } from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper, TextField, Button, IconButton, CircularProgress, Fade } from '@material-ui/core';\r\nimport notaryManagerStyles from '../styles/NotaryManager';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport Title from './Title';\r\nimport { useSnackbar } from 'notistack'; \r\nimport MaterialTable from 'material-table';\r\nimport tableIcons from './tableIcons';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\n\r\nconst useStyles = makeStyles(notaryManagerStyles);\r\n\r\nexport default function ListAllNotaries(props) { \r\n  const {web3Manager, setLoading} = props; \r\n  const classes = useStyles(); \r\n  const snackbar = useSnackbar();\r\n\r\n  const [componentMounted, setComponentMounted] = useState(false);\r\n  const [rows, setRows] = useState([]);\r\n\r\n  React.useEffect(() => { \r\n    web3Manager.listAllNotaries().then((notaries) => {setRows(notaries); setComponentMounted(true);}).catch(() => setComponentMounted(true)); \r\n  }, []); \r\n \r\n  return (\r\n    <Grid item xs={12}>\r\n      <Paper className={classes.paper}>\r\n        <Grid container>\r\n          <Grid item style={{flexGrow: 1}}>\r\n\r\n          <Title>\r\n            Lista notariuszy\r\n          </Title>\r\n          </Grid>\r\n          <Grid item>\r\n            <IconButton onClick={() => { \r\n              web3Manager.listAllNotaries().then((notaries) => {setRows(notaries); setComponentMounted(true);}).catch(() => setComponentMounted(true)); \r\n            }}> \r\n              <RefreshIcon />    \r\n            </IconButton>\r\n          </Grid>\r\n        </Grid>\r\n        <Typography variant=\"body1\">\r\n          Poniżej lista wszystkich notariuszy należących do systemu.\r\n        </Typography>  \r\n        <div className={classes.notariesList}>\r\n          {componentMounted ? (\r\n          \r\n            <MaterialTable\r\n                components={{\r\n                  Container: props => <div {...props}/>\r\n                }}\r\n                columns={[\r\n                  { title: \"Adres Notariusza\", field: \"notaryPublicKey\" },\r\n                  { title: \"Status\", field: \"status\" },\r\n                  { title: \"Block number\", field: \"block\"}\r\n                ]}\r\n                data={rows}\r\n                icons={tableIcons}\r\n                title=\"Notariusze\" \r\n                // onSelectionChange={handleSelectionChange}\r\n                options={{\r\n                  filtering: false,\r\n                  sorting: true,\r\n                  grouping: false,\r\n                  draggable: false,\r\n                  paging: true,\r\n                  pageSize: 5,\r\n                  pageSizeOptions: [5, 10, 25, 50, 100],\r\n                  selection: false,\r\n                  actionsColumnIndex: -1\r\n                }} \r\n                localization={{\r\n                  body:{\r\n                    emptyDataSourceMessage: \"Brak notariuszy w sytemie.\"\r\n                  }\r\n                }}\r\n              />\r\n              \r\n          ) : (  \r\n            <Fade in> \r\n              <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\r\n                <Typography gutterBottom className={classes.connectServerText}>\r\n                  Wczytywanie notariuszy...\r\n                  </Typography>\r\n                <CircularProgress />\r\n              </Grid> \r\n            </Fade>\r\n          )} \r\n        </div>\r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n ","import React from 'react'; \r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Grid, Paper } from '@material-ui/core';\r\nimport notaryManagerStyles from '../styles/NotaryManager';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport Title from '../views/Title';\r\nimport AddNotaryForm from '../views/AddNotaryForm';\r\nimport EditNotaryForm from '../views/EditNotaryForm';\r\nimport DeleteNotaryForm from '../views/DeleteNotaryForm';\r\nimport ListAllNotaries from '../views/ListAllNotaries';\r\n\r\nconst useStyles = makeStyles(notaryManagerStyles);\r\n\r\nexport default function NotaryManager(props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <Paper className={classes.paper}>\r\n          <Title>\r\n            Panel zarządzania notariuszami\r\n          </Title>\r\n          <Typography variant=\"body1\">\r\n            Jako administrator masz dostęp do panelu zarządzania notariuszami. W tym panelu możesz dodawać i usuwać notariuszy. Tylko autoryzowani notariusze mogą dodawać dokumenty do systemu.\r\n          </Typography> \r\n\r\n        </Paper>\r\n      </Grid>\r\n      <ListAllNotaries web3Manager={props.web3Manager} setLoading={props.setLoading}/>\r\n      <AddNotaryForm web3Manager={props.web3Manager} setLoading={props.setLoading} />\r\n      <EditNotaryForm web3Manager={props.web3Manager} setLoading={props.setLoading} />\r\n      <DeleteNotaryForm web3Manager={props.web3Manager} setLoading={props.setLoading} />\r\n    </Grid>\r\n  );\r\n}\r\n ","import React from 'react'; \r\nimport web3Manager from '../helpers/web3Manager';\r\nimport { Grid, Typography, Dialog, DialogTitle, DialogContent, IconButton, Tooltip, Table, TableHead, TableRow, TableCell, TableBody } from '@material-ui/core';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\n\r\nexport default function AccountDataView(props) {\r\n  \r\n  const [open, setOpen] = React.useState(false);\r\n  const [curentBalanceText, setCurentBalanceText] = React.useState(\"Wczytywanie...\");\r\n  const handleOpen =() => {\r\n    setCurentBalanceText(\"Wczytywanie...\");\r\n    web3Manager.getCurrentBalance()\r\n      .then((value) => setCurentBalanceText(web3Manager.fromWei(value, 'ether') + ' ETH'))\r\n      .catch((err) => {\r\n        console.error(err);\r\n        setCurentBalanceText(\"Blad wczytywania.\");\r\n      });\r\n\r\n    setOpen(true);\r\n    \r\n  }\r\n\r\n  const handleClose = () => { \r\n    setOpen(false);\r\n  }\r\n  return (\r\n    <div> \r\n      <Tooltip title=\"Wyswietl profil\">\r\n        <IconButton\r\n          color=\"inherit\"\r\n          onClick={handleOpen}\r\n          >\r\n          <AccountCircle />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Dialog onClose={handleClose} open={open}  maxWidth={'xl'}>\r\n        <DialogTitle>Informacje o uzytkowniku</DialogTitle>\r\n        <DialogContent>\r\n          <Grid container style={{display:'block'}}>\r\n            <Grid item>\r\n              <Typography variant=\"body1\">\r\n                To okno prezentuje dane o twoim koncie niezbędne do poprawnego użytkowania aplikacji.\r\n              </Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <Table size=\"small\">\r\n                <TableHead>\r\n                  <TableRow>\r\n                    <TableCell style={{ width: '30%' }}>Parametr</TableCell>\r\n                    <TableCell>Wartość</TableCell> \r\n                  </TableRow>\r\n                </TableHead>\r\n                <TableBody> \r\n                <TableRow >                      \r\n                    <TableCell>\r\n                      <Typography>\r\n                        <b>\r\n                          Twoj Klucz Publiczny\r\n                        </b>\r\n                      </Typography>\r\n                    </TableCell>\r\n                    <TableCell >\r\n                      {web3Manager.getPublicKeyForSelectedAddress()}  \r\n                    </TableCell>\r\n                  </TableRow> \r\n\r\n                  <TableRow >                      \r\n                    <TableCell>Address Konta</TableCell>\r\n                    <TableCell >\r\n                      {web3Manager.selectedAddress}\r\n                    </TableCell>\r\n                  </TableRow>  \r\n\r\n                  <TableRow >                      \r\n                    <TableCell>Srodki na koncie</TableCell>\r\n                    <TableCell >\r\n                      {curentBalanceText}\r\n                    </TableCell>\r\n                  </TableRow>  \r\n                  \r\n                </TableBody>\r\n              </Table> \r\n            </Grid>\r\n          </Grid> \r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n ","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Box from '@material-ui/core/Box';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Container from '@material-ui/core/Container';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Link from '@material-ui/core/Link';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport {\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport axios from 'axios';\r\nimport { listMenuItems } from '../views/ListItems';\r\nimport dashboardStyles from '../styles/Dashboard';\r\nimport routes from '../routes.json';\r\nimport Home from './Home';\r\nimport AddDocument from './AddDocument';\r\nimport Error404 from './Error404';\r\nimport Login from '../views/Login';\r\nimport config from '../config.json';\r\nimport { CircularProgress, Fade, Button, LinearProgress } from '@material-ui/core';\r\nimport { useSnackbar } from 'notistack';\r\nimport Web3Provider from './Web3Provider';\r\nimport NotaryManager from './NotaryManager';\r\nimport AccountDataView from '../views/AccountDataView';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright © '}\r\n      <Link color=\"inherit\">\r\n        Krzysztof Kamiński & Artur Haczek\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\nconst useStyles = makeStyles(dashboardStyles);\r\n\r\nexport default function Dashboard() {\r\n  const snackbar = useSnackbar();\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(window.localStorage.getItem('openDrawer') !== \"false\");\r\n  const [isLoading, setLoading] = React.useState(false);\r\n  const [accountSelected, setAccountSelected] = React.useState(null);\r\n  const [isNotaryManager, setNotaryManager] = React.useState(false);\r\n  const [isNotary, setNotary] = React.useState(false);\r\n  const [loggedIn, setLoggedIn] = React.useState(false);\r\n  const [logoutInProgress, setLogoutInProgress] = React.useState(false);\r\n  const [componentMounted, setComponentMounted] = React.useState(false);\r\n  const [document, setDocument] = React.useState(undefined)\r\n  const handleDrawerOpen = () => {\r\n    setOpen(true);\r\n  };\r\n  const handleDrawerClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setLogoutInProgress(true);\r\n      await axios.get(`${config.apiUrl}/logout`);\r\n      setLoggedIn(false);\r\n      setAccountSelected(null);\r\n    } catch (err) {\r\n      console.error(err);\r\n      snackbar.enqueueSnackbar(\"Nie udało się poprawnie wylogować. Error: \" + err.message, { variant: 'error' })\r\n    } finally {\r\n      setLogoutInProgress(false);\r\n      setLoading(false);\r\n    }\r\n  }\r\n  React.useEffect(() => {\r\n    if(config.includeNotaryPanel){ \r\n      axios.get(`${config.apiUrl}/isLoggedIn`).then(() => {\r\n        setLoggedIn(true);\r\n        setComponentMounted(true);\r\n      }).catch((err) => {\r\n        setComponentMounted(true);\r\n      });\r\n    }else{ \r\n      setComponentMounted(true);\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    window.localStorage.setItem('openDrawer', open);\r\n  }, [open]);\r\n  console.log(\"accountSelected\", accountSelected);\r\n  return (\r\n    <div className={classes.root}>\r\n      <CssBaseline />\r\n      <AppBar position=\"absolute\" className={clsx(classes.appBar, open && classes.appBarShift)}>\r\n        <Toolbar className={classes.toolbar}>\r\n          <IconButton\r\n            edge=\"start\"\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={handleDrawerOpen}\r\n            className={clsx(classes.menuButton, open && classes.menuButtonHidden)}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography component=\"h1\" variant=\"h6\" color=\"inherit\" noWrap className={classes.title}>\r\n            System przechowywania dokumentów notarialnych\r\n          </Typography>\r\n          {accountSelected && (\r\n            <AccountDataView accountSelected={accountSelected}/>\r\n          )}\r\n          {config.includeNotaryPanel && loggedIn &&\r\n            <Button variant=\"outlined\" color=\"inherit\" classes={{ root: classes.logout, disabled: classes.disabled }} onClick={handleLogout} disabled={logoutInProgress}>\r\n              Wyloguj się\r\n          </Button>\r\n          }\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        classes={{\r\n          paper: clsx(classes.drawerPaper, !open && classes.drawerPaperClose),\r\n        }}\r\n        open={open}\r\n      >\r\n        <div className={classes.toolbarIcon}>\r\n          <IconButton onClick={handleDrawerClose}>\r\n            <ChevronLeftIcon />\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        {listMenuItems(isNotary, isNotaryManager)}\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.appBarSpacer} />\r\n        <LinearProgress className={clsx({ [classes.hideProgress]: !isLoading, [classes.loadingProgress]: true })} />\r\n\r\n        <Container maxWidth={false} className={classes.container}>\r\n          {loggedIn &&\r\n            <Web3Provider\r\n              setAccountSelected={setAccountSelected}\r\n              setLoading={setLoading}\r\n              setNotaryManager={setNotaryManager}\r\n              setNotary={setNotary}\r\n              document={document}\r\n              setDocument={setDocument}\r\n              render={(props) => (\r\n                <Switch>\r\n                  <Route exact path={routes.home}>\r\n                    <Home {...props} />\r\n                  </Route>\r\n                  {isNotary &&\r\n                    <Route path={routes.addDocument}>\r\n                      <AddDocument {...props} />\r\n                    </Route>\r\n                  }\r\n                  {isNotaryManager &&\r\n                    <Route path={routes.notaryManager}>\r\n                      <NotaryManager {...props} />\r\n                    </Route>\r\n                  }\r\n                  <Route>\r\n                    <Error404 {...props} />\r\n                  </Route>\r\n                </Switch>\r\n              )}\r\n            />\r\n          }\r\n          {!loggedIn && componentMounted &&\r\n            <Login setLoggedIn={setLoggedIn} setLoading={setLoading} />\r\n          }\r\n          {!componentMounted &&\r\n            <Fade in timeout={1000}>\r\n              <Paper className={classes.paper}>\r\n                <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\r\n                  <Typography gutterBottom className={classes.connectServerText}>\r\n                    Łączenie z serwerem\r\n                    </Typography>\r\n                  <CircularProgress />\r\n                </Grid>\r\n              </Paper>\r\n            </Fade>\r\n          }\r\n        </Container>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Dashboard from './Dashboard';\r\nimport { createMuiTheme, MuiThemeProvider, Button, IconButton } from '@material-ui/core'; \r\nimport { SnackbarProvider } from 'notistack';\r\nimport {HashRouter as Router} from 'react-router-dom';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: \"#19486A\",\r\n      contrastText: \"#FFFFFF\"\r\n    },\r\n    secondary: {\r\n      main: \"#00689D\"\r\n    }\r\n  },\r\n  status: {\r\n    danger: 'orange',\r\n  },\r\n});\r\n\r\n\r\nexport default function Chart() {\r\n  \r\n  const notistackRef = React.createRef(); \r\n\r\n  return (\r\n    <MuiThemeProvider theme={theme}>\r\n      <SnackbarProvider \r\n        ref={notistackRef} \r\n        maxSnack={5} \r\n        action={(key) => (\r\n          <IconButton color=\"inherit\" onClick={() => { \r\n            notistackRef.current.closeSnackbar(key);\r\n          } }>\r\n            <CloseIcon/>\r\n          </IconButton>\r\n        )}\r\n        autoHideDuration={null}\r\n      >\r\n        <Router>\r\n          <Dashboard />\r\n        </Router>\r\n      </SnackbarProvider>\r\n    </MuiThemeProvider>\r\n  );\r\n}\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport App from './components/App';\nimport 'typeface-roboto';\nimport axios from 'axios';\n\n\naxios.defaults.withCredentials = true\n\nReactDOM.render(\n<App/>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import crypto from 'crypto'; \r\n\r\nconst encrypt = (buffer, key) => {\r\n  const algorithm = 'aes256'; \r\n\r\n  const cipher = crypto.createCipher(algorithm,key);\r\n  const encrypted = Buffer.concat([cipher.update(buffer),cipher.final()]);\r\n  return encrypted;\r\n};\r\n   \r\nconst decrypt = (buffer, key) => {\r\n  const algorithm = 'aes256';\r\n\r\n  const decipher = crypto.createDecipher(algorithm,key);\r\n  const decrypted = Buffer.concat([decipher.update(buffer) , decipher.final()]);\r\n  return decrypted;\r\n};\r\n\r\n\r\nexport default {\r\n  encrypt,\r\n  decrypt\r\n};\r\n"],"sourceRoot":""}